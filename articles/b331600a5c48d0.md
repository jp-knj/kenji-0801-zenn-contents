---
title: "stylelint入門"
emoji: "🌊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---
# はじめに
CSSに怒りや苛立ちを覚えた方も少なくはないのではないでしょうか。
ですが、CSSの品質管理ツールをどのように活用するのか議論が少ない印象を持っております。
`Vue CLI`や`Create React App` などのフロントエンド開発ツールには ESLintの設定が含まれていますが、CSS の linter は含まれてはないのです。
そこで、**stylelint** を使って、エラーを検知、フォーマットの一貫性やスタイリングの重複を防ぐことができます。
チームでCSSを書いたり、生産性や保守性を高めたいときに **stylelint** は活躍してくれます。
この記事は、**stylelint** の使い方を紹介します。

## styelintとは？
stylelintを初めて利用する方は、stylelintのコアメンバーである David Clark が執筆した [こちら](https://css-tricks.com/stylelint/) を参照するのを薦めます。

## stylelintでできること
100以上のルールと徹底した拡張性というstylelintの特徴を要約する試みです。
stylelintは多くのルールが利用でき、その数は150を超えます（プリプロセッサー構文用の言語固有のルールを除く）。
少し時間を取ってこれらのルールを見ていくと、記述するスタイルにぴったりのルールセットを実装するときに役立つでしょう。

- HTML
- マークダウン
- CSS-in-JS オブジェクト
- テンプレート リテラル
基本的に、Stylelint はあらゆる形式の CSS を、あらゆる場所で解析することができるはずです。ESLintと同様に、エラーを検出するためのルールが組み込まれており、いくつかのエラーを自動的に修正することができます。共有可能な設定に対応し、機能を拡張するプラグインもあります。コードエディタ、タスクランナー、いくつかのバンドルソフトと統合されています。

主に３つほど要点を挙げます
- エラーを検知する
- ベストプラクティスを提供する
- コーディングルールを徹底する

### エラーを検知する
デバックや改修時に頭を悩ませる原因の一つにセレクタ、プロパティ共に、スタイルシート内で重複するものがあります。
具体例を上げてみましょう。
```css:example
// 1番目
.foo {
  color: red;
  display: block;
  width: 100px;
  height: 100px;
}
.bar {
  color: blue;
  display: block;
  width: 100px;
  height: 100px;    
}
// 2番目
.foo {
  color:yellow;
}
```
1番目に書いた .foo にある `color` プロパティは、2番目に書いた .foo にある `color` プロパティと重複しています。
当然、CSS上ではエラーは発生しません。ですが、stylelintは`declaration-block-no-duplicate-properties`ルールを有効にするとエラーを検知してくれます。

### コーデイングルールを徹底する
stylelintは、コードのスタイル規則を自動的に強制する多くのルールを備えているので、あなたやあなたのチームメイトは、そのようなルールを強制される必要はありません。私たちは、これらのルールを非常に包括的かつ非常に柔軟にすることを心がけました。

これらのルールは主にホワイトスペースに関するものですが、引用符や文字の大文字小文字、分数の先頭のゼロ、キーワードの使用と値のスペルアウトなど、他の細かい点も対象にしています。

夢は、あなたとあなたのチームメイトが一度フォーマット規約を確立し（例えば「宣言のコロンの後には常に半角スペースを入れよう！」）、stylelintの設定にそれを成文化し、その後二度とそれについて話すことがないようにすることです。強制は機械帝国に任せればいいのです。

### ベストプラクティスを提供する
スタイルシートに体系的な手法を用いたり、コードのスタイルガイドを用意したりすれば、特定のパターンを決定的に禁止することができるはずです。stylelintはそのための手段を提供します。

何よりも、セレクタを制御する必要があります。冷酷に。stylelint を使用すると、ある特定の範囲を超えるセレクタを無効にしたり、ネストの深さに上限を設定したりすることができます。セレクタのカテゴリを禁止したり（例：idセレクタの禁止）、正規表現を使用して残りのセレクタの命名規則を強制することができます。

importantの使用を禁止したり、サポートしているブラウザに適用されないブラウザハックを禁止することができます。Autoprefixer を使っている場合 (おそらく使うべきです)、ソーススタイルシートでのベンダープレフィックスの使用を禁止することができます。
Stylelint は埋め込まれたスタイルを抽出することができます。

## styelint を使ってみる
まず、npm を使って Stylelint をインストールし、コアとなるルールセットを有効にするために stylelint-config-standard も一緒にインストールします。Stylelint-config-standardは、idiomatic CSS principlesやAirbnbのスタイルガイドなど、一握りのCSSスタイルガイドに共通するスタイル上の慣習をベースにしています。

```shell
$ npm install --save-dev --save-exact stylelint stylelint-config-standard
```

プロジェクトのルートに設定ファイルを作成します。
```shell
$ touch .stylelintrc.json
```
または
```shell
$ touch .stylelintrc
```
```json:example
{
  "extends": "stylelint-config-standard"
}
```
これでコマンドラインからStylintを実行できるようになりました。例えば、プロジェクト内のCSSファイルのみを対象とする場合は、stylelint "**/*.css" と実行します。エラーを自動的に修正するには、-fixフラグを追加してください。
Stylelintに慣れるために、標準的なルールに目を通しておくとよいでしょう。空白の設定から始めて、必要なルールだけを追加することを提唱する人もいれば、標準の設定をベースにして、経験を積むにつれて修正していく人もいます。

後者は確かに一番手っ取り早い方法です。最初は自動修正をオフにして、よく発生するエラーを見て理解できるようにするのがいいと思います。ある程度理解できたら、自動修正をオンにしてください。もちろん、あなた次第です!