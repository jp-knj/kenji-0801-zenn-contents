---
title: "QA：アクセシビリティの評価"
---
## Accessibility Conformance Testing 
Web アクセシビリティの重要性は高まっていますが、具体的にどのようにそれを確保するかは、多くの開発者にとって未知の領域ではないでしょうか。この記事では、ACT(Accessibility Conformance Testing)を中心に、効率的なアクセシビリティテストの進め方を解説します。

### ACT とは
アクセシビリティ適合性試験（Accessibility Conformance Testing）の略です。
WCAG は Web アクセシビリティのガイドラインとして広く知られていますが、具体的なテスト方法までが記載されているわけではありません。ここで ACT ルールが役立ちます。このルールは、特に WCAG で明確に触れられていないエッジケースを中心に、アクセシビリティの適合性を確認するための方法を提供しています。

#### ツールとの関係性について
様々な Web アクセシビリティテストツールが存在します。Web アクセシビリティツールを利用することで効率的に問題を見つけることができるようになるでしょう。
ですが、ツールだけに頼るのは危険です。例えば、画像の代替テキスト（alt 属性）は、内容が適切かどうかをツールだけで判断するのは難しいです。ページの文脈によっては、同じ画像でも異なる代替テキストが適切なときも考えられます。

ACT ルールの役割[^1]は、テスト方法を手動テストや自動テストに分け、それぞれのテストの標準を定めています。これにより、一貫性のあるアクセシビリティ評価を目指しています。

- **基準の明示** ： ACT ルールは、WCAG や WAI-ARIA のようなアクセシビリティ基準にどのように合致しているか、または合致していないかを明確にするための具体的なテストケースを示します。
- **手動・自動テストの一貫性** ： ACT ルールは、手動でのテスト方法と自動テストツールが示す結果が一貫していることを保証するための基準となります。これにより、テスターはどのような方法を用いても、同じ基準でテストができるという利点があります。
- **エッジケースの取り扱い** ： Web ページやアプリケーションは複雑で、常に予期しない状況やエッジケースが発生します。ACT ルールは、これらのエッジケースにおいても、どのようにアクセシビリティを評価すればよいかを示す指針を提供します。

完璧なスコアをツールで得たとしても、完璧な Web ページとは限りません。ACT ルールを取り入れることで、よりユーザーのためにアクセシビリティ向上を実現する手助けを得られるでしょう。

### ACTルールの目的
#### 情報提供の役割 
ACT ルールは、WCAG への適合性を判断するための基礎ではなく、むしろ参考情報としての位置づけです。その主な目的は、WCAG 標準の達成基準に基づいて、適合性の確認を補完することです。
W3C との関係についてですが、W3C の List of ACT Rules for WCAG 2[^2] は、W3C の AGWG[^3] によってレビューされています。しかし、このリストは WCAG 標準ほど詳細に精査されているわけではありません。そのため、ACT ルールだけを完全に信頼するのではなく、WCAG 標準と併用して利用することが推奨されます。

#### 全てではなく、部分的なチェックの実施
ACT ルールは、WCAG 達成基準の一部分を焦点にしています。例として、テーブルのヘッダーの有効性に関する特定のルールが挙げられます。
WCAG 2.2 の達成基準は、技術的な制約を受けずに設計されています。ですが、ACT ルールは、特定の技術や実装に特化しています。このため、全てのウェブ技術やコンテンツタイプに適用可能なわけではありません。

**事例**
あるページには多数のテーブルが配置されており、それぞれが異なる情報を提示しています。一部のテーブルは、財務データを示しており、ヘッダーセルが各列や行のデータを説明しています。ACT の特定のルールは、このヘッダーセルが正しく配置されているか、そして適切に機能しているかを評価するかもしれません。しかし、それは WCAG 達成基準 1.3.1「情報及び関係性」の全体的な達成基準を評価するものではありません。

#### 失敗の特定
失敗をチェックする目的：ACT ルールは、特定の WCAG 達成基準を満たしているかどうかの失敗を確認することを主な目的としています。

**事例**
あるページには複数のリンクが存在するとします。ACT ルールの 1 つは、これらのリンクがキーボード操作だけでアクセス可能かどうかをチェックします。リンクがキーボード操作でアクセスできないとき、このルールは「失敗」ということになるでしょう。

合格と失敗の意味：コンテンツが ACT ルールに合格した場合、それは該当の失敗が検出されなかったということですが、すべての達成基準を満たしているわけではありません。ACT ルールの主な目的は、アクセシビリティ要件の不適合な部分、すなわち「失敗」を特定することです。これにより、開発者は具体的な修正ポイントを把握しやすくなります。完全な適合性の確認には、人間による詳細な検証が必要です。

**事例**
キーボード操作のルールに「合格」した場合、ページ上のリンクはキーボードでアクセス可能です。しかし、それは他のアクセシビリティの達成基準、例えばリンクのテキストが十分に説明的であるかどうか、に関しては何も保証しません。したがって、完全な適合性を確認するためには、他の ACT ルールや人間の検証者による詳細な検証が必要となるでしょう。

#### 注意点
WCAG 2 の適合要件 1 は、「適合する代替バージョン」を許可しています。これは、コンテンツが ACT ルールに失敗しても、コンテンツが WCAG 2 に適合している可能性があることを意味します。

## ルール設計
WCAG-ACT-RULES-CG のルール設計は、WCAG 2.x とそのサポートドキュメントに基づいています。
- **ルールの属性**：テスト対象とその環境を定義します。識別子、名前、タイプ、説明などの他のメタデータも含まれます。
- **適用性**：ルールを使用してページ上のどの要素をテストするかを特定します。
- **期待値**：ルールを合格させるためにターゲット要素について真実でなければならないことを断言します。
- **仮定**：結果の説明責任を確保するために、ルールによって明示的に仮定されるすべてのことを明記します。
- **アクセシビリティサポート**：支援技術やユーザーエージェントの既知の機能サポートの問題に関する情報を提供します。
- **背景**：ルールの開発時に参照された関連リソースに関する情報を提供します。
- **テストケース**：実装を検証し、読者に合格、不合格、不適用の結果を示すコードの例範囲を定義します。
- **用語集**：ルールファイル内で使用される定義済みの用語のリスト。

### 具体例：`<image>` タグのアクセシビリティテスト
#### ルールの属性
- **ID**: ACT-RULE-001-IMG
- **名前**: `<image>` タグのアクセシビリティ評価
- **タイプ**: 自動
- **説明**: このルールは、Web ページに含まれる `<image>` タグがアクセシビリティ基準を遵守しているかを評価します

#### 適用性
- HTML の `<image>` タグがページに存在する場合。

#### 期待値
- すべての `<image>` タグには `alt` 属性が存在し、適切な代替テキストが提供されていること。

#### 仮定
- 画像は視覚的なコンテンツとして情報を提供する目的で使用されている。
- テキスト以外のメディア（音声やビデオなど）が `<image>` タグの代替として使用されていない。

#### アクセシビリティサポート
- ほとんどのブラウザや支援技術は `alt` 属性をサポートしています。

#### 背景
- WCAG 2.x の達成基準 1.1.1（非テキストコンテンツ）

#### テストケース

##### 合格例
```html
<image src="flower.jpg" alt="赤い花のクローズアップ">
```

##### 不合格例
```html
<image src="flower.jpg">
```

##### 不適用例
```html
<div style="background-image: url('flower.jpg');"></div>
```
```html
<image src="flower.jpg" alt="">
```

#### 用語集
- **`<image>` タグ**: HTML で画像を埋め込むためのタグ。
- **`alt` 属性**: 画像の内容をテキスト形式で説明するための属性。

---

このルールは、Web ページのアクセシビリティを向上させるための一助となることを目的としています。具体的なコンテンツやコンテキストに応じて、詳細なテストや評価が必要となる場合がありますので、注意してください。

### ACTルール テストケース設計
#### テストケースの目的
ACT ルールのテストケースは、実装者が自らの実装が正確であること、つまりアクセシビリティ基準やガイドラインに一致していることを確認するためのツールです。実際の Web ページやアプリケーションにおいて、多様な状況や条件が考えられるため、それらのシチュエーションにおいても ACT ルールが正確に機能することが求められます。

#### テストケースの範囲
一方で、どの程度のテストケースを用意するか、その範囲をどこまで広げるかは、ルールの著者の判断に委ねられます。ただし、エッジケースの選定や優先順位付けは、実際の Web ページやアプリケーションでの具体的な問題点や挙動に基づいて行うべきです。

テストケースの良いバランスを取るために、以下の原則を考慮する必要があります。

- 条件を網羅する： ルールのすべての条件に対応するテストケースを持つことは基本です。しかし、不足している場面や冗長なテストが存在することも。これを改善するためには、定期的なレビューとアップデートが必要です。
- 単一の目的を持つテストケース： テストケースは、一度に 1 つの条件のみをテストすべきです。これにより、テスト結果の解析が容易になり、問題の特定も簡単になります。
- 小さいテストケース： 実際の Web ページやアプリケーションでの具体的な問題や挙動を基に、エッジケースを洗い出し、それに基づいてテストケースを作成することが必要です。
- 定義の明確化： ACT ルールは、重複を避け、詳細を隠すための定義です。しかし、これらの定義は時に曖昧になることが。定義を常に明確にし、それに基づいたテストケースを作成することが求められます。
- アクセシビリティサポートの課題： 一部の技術や要件が完全にサポートされていない場面があるため、それに対応するテストケースは慎重に取り扱う必要があります。
- 例外の考慮： すべての原則やテストケースには例外が存在する可能性があります。これらの例外を明示的に記述し、それに対応するテストケースを追加することで、網羅性を高めることができます。

#### 条件を網羅する
例： "img" と "svg" の要素
ルールやガイダンスが指定する条件に基づいて、それぞれの要素や属性に対するテストケースを設計する必要があります。

以下のようなテストケースが考えられます。
- ルールに合格する img: このテストケースでは、img 要素がルールの条件を満たしている場合を示します。たとえば、alt 属性が適切に提供されているときです
- ルールに合格する svg: svg 要素がルールの条件を満たしている場合を示します。例えば、役割やアクセシビリティ属性が正しく設定されているときです
- ルールに合格しない img: img 要素がルールの条件を満たしていない場合を示します。たとえば、alt 属性が欠落しているときです
- ルールに合格しない svg: svg 要素がルールの条件を満たしていない場合を示します。例えば、role が不適切に設定されているときです
- 適用できない他の要素： ルールが適用されない要素を示すテストケース。例えば、div や span など、img や svg 以外の要素に関するときです

これらのテストケースを提供することで、実装者は自らの実装が正しく、一貫性があり、期待通りに動作するかを確認できます。特に、異なる要素に対するテストケースを明確に分けることで、実装の精度や一貫性を向上させることが期待されます。

#### 単一の目的を持つテストケース
テストケースは、一度に 1 つの"条件"だけをテストする必要があります。これにより、それらを集中的にし、理解しやすくなります。複数のケースを 1 つの例に組み合わせるのは魅力的です。しかし、その例が期待される結果を得られない場合、問題の原因を特定するのが難しくなります。

テストケースを書くときは、条件付きのロジックに注目することが重要です。例えば適用可能性が要素が「可視でアクセシビリティツリーに含まれている」と指定されている場合、合格と失敗の例に加えて、真でない理由が 3 つ考えられます。これらの全てをテストする必要があります。

- 適用できない： 可視だが、アクセシビリティツリーには含まれていない
- 適用できない： 不可視だが、アクセシビリティツリーには含まれている
- 適用できない： 不可視で、アクセシビリティツリーにも含まれていない

#### アクセシビリティ要件との一貫性
実装のマッピングが動作するためには、テストケースはアクセシビリティ要件と一貫している必要があります。これは、合格および適用できないテストケースが、ルールのアクセシビリティ要件、およびこのルールが設計された任意のコンポジットルールのアクセシビリティ要件を満たしていることを要求します。アクセシビリティ要件を満たさない適用できない条件は含められるべきではありません。例えば、2.4.2 ページのタイトルをテストする場合、タイトルが記述的であるというルールは、タイトルが必要であるが持っていないページの適用できない例を持っていることはできません。

これに関連して、失敗したテストケースは、1 つの理由だけでアクセシビリティ要件に違反している必要があります。4.1.2 名前、役割、値の失敗したテストケースは、アクセシブルな名前と役割の両方に問題があってはなりません。もしルールがアクセシブルな名前に関するものであれば、役割と値は正しくなければなりません。

適用可能性と合格の結果の間には実装のマッピングに違いがほとんどありません。そのため"見た目が悪い"ものでも、実際にはアクセシビリティ要件を満足している適用できないテストケースを持つことが推奨されます。ツールが適用可能性を正しく実装していない場合、このテストケースに失敗するでしょう。例として、1.4.3 コントラスト（最小）のテストを考えます。ルールは無効なボタンに適用されない可能性があるのは、成功基準の第二の例外に一致するからです。この条件下での適用できないテストケースは、背景とのコントラスト比が 2.0:1 の無効なボタンを含む方が、5.0:1 の無効なボタンを含む場合よりも優れています。後者のケースでは、ツールが無効なボタンを無視しない場合、テストケースに合格する可能性があります。Applicability のテストに関して、"見た目が悪い"と感じられる適用できない例が常に存在するわけではありません。

#### 小さなテストケース
テスト設計の一般的な原則は、テストケースを小さく保つことです。不要なコンテンツは避けてください。それは結果に予期しない副作用を引き起こす可能性があります。例えば、ボタンに関するルールでは、すべてのテストケースに lang 属性と title 要素を持つ HTML 要素が必要なわけではありません。これらの要素はボタンのアクセシビリティに影響しません。テストケースのすべてのコードは、ルールまたはそのアクセシビリティ要件に関連している必要があります。

その例外として、ACT ルールは良好なアクセシビリティの慣行を示すよう努力すべきです。autocomplete 属性が有効であるというルールは、autocomplete 属性を持つフォームコントロールのラベルを提供する必要があります。これらのラベルは、入力の意図された目的を示すコンテキストを提供するとともに、フォームコントロールにラベルを提供する良い慣行を示しています。

#### 表面的な定義のテスト
ACT ルールは、重複を避け、詳細を"隠す"ために定義を使用します。"セマンティックロール"、"可視"、"アクセシブルな名前"などの定義は、多くのルールで使用され、ACT の基本的な構築要素です。特定の定義を使用するすべてのルールで多くの類似したテストケースを持つことを避けるために、定義のテストを最小限に抑えるのが最善です。

例として、"X には空でないアクセシブルな名前がある"というルールはすべて、要素がアクセシブルな名前を持つことができる異なる方法をチェックするテストケースを持っています。img の場合、それは alt、title、および aria-label(ledby)属性です。これは、基本が理解されていることを確保するのに十分なカバレッジを作成します。しかし、これらのルールは、アクセシブルな名前の計算が正しく行われていることを確保するための詳細には入らない。実装者がアクセシブルな名前の計算で aria-owns を考慮するかどうかは、"空でないアクセシブルな名前"のルールに関連していません。

それは、定義のエッジケースには決してテストケースがないと言うことではありません。特定のエッジケースがルールの結果に影響する実世界の例がある場合、そのエッジケースをカバーするためにルールにテストケースが追加されるべきです。

#### アクセシビリティサポートの問題を避ける
ルールには、完全にサポートされていない技術を関与させることがかなり一般的です。例えば、ARIA の役割は数年ごとに追加され、新しい役割が支援技術によって採用されるのにはしばらく時間がかかります。特定の技術がほとんどまたは全くサポートされていない場合、ルールはこのためのテストケースを持っているべきではありません。

特定の技術に対するサポートが十分にある場合、テストケースを検討すべきです。部分的にサポートされている技術を導入する最良の方法は、それらに対して失敗したテストケースを提供することのみです。これにより、この技術をサポートしていない実装が部分的に一貫していることが確認されます。

広くサポートされている技術は、すべてのテストケースで使用できます。すべての状況で、テストケースが必要かどうかを決定する前の原則は、まだ適用されます。

#### 例外
すべてのこれらの原則に例外があることを知っておくことが重要です。特定のテストケースを含めない技術的な理由がある場合や、組み合わせの数が不合理な数のテストを必要とする場合があります。合格したテストケースがすべてのアクセシビリティ要件を満たしていることが論理的に意味をなさない場合もあります。一部の定義にはテストが不要である場合があり、他のものは広範なテストが必要だと主張できます。など。

実際の例が一貫性を前進させるための駆動力となることを意味します。ルールの著者は、すべての考えられる状況のテストケースを書くのに困ることはありません。ルールの著者は、初版での実装者間の 95%の一貫性を目指すべきです。このパーセンテージを測定する必要はありません、これは目指すべきもののアイデアを提供することを意図しています。より多くの例が発見されるにつれて、この数字は時間とともに上がっていきます。

[^1]:[WCAG 達成基準のテストルールを理解する](https://waic.jp/translations/WCAG21/Understanding/understanding-act-rules) を参考しています。
[^2]:[All ACT Rules](https://www.w3.org/WAI/standards-guidelines/act/rules/)
[^3]:[Accessibility Guidelines Working Group](https://www.w3.org/WAI/GL/)
https://act-rules.github.io/pages/design/test-cases/
https://act-rules.github.io/pages/design/rule-design/
https://www.w3.org/TR/act-rules-format/